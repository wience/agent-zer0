{
  "title": "my.getOpenUserInfo",
  "content": "# my.getOpenUserInfo\n\n2021-05-09 18:43\n\nGet the basic information about a user. This feature requires the user to deliberately trigger to activate the function. This function is not directly called by the API but rather waits for when the user has activated it by clicking a `<button>` component. If the Mini Program wants to get userId, please call `my.getAuthCode`.\n\nFor more information, please refer to the [obtain basic member information](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev-old/api_openapi_obtainbasicmemberinformation).\n\n## Use Attention\n\nYou need to set the value of the `<button>` component `open-type` to `getAuthorize` and set the value of the `scope` to `userInfo` . After the user clicks the authorization button, the Mini Program can get the user information returned by the `my.getOpenUserInfo` JSAPI.\n\n`my.getOpenUserInfo` will send a network request to the server to obtain user information, so it may be take some time before the callback function invoked.\n\n## Parameters\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **Name** | **Type** | **Required** | **Description** |\n| success | Function | No | Callback function upon call success. |\n| fail | Function | No | Callback function upon call failure. |\n| complete | Function | No | Callback function upon call completion (to be executed upon either call success or failure). |\n\n### Success Callback Function\n\nThe incoming parameter is of the Object type with the following attributes:\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **Name** | **Type** | **Required** | **Description** |\n| code | String | NO | The result code. |\n| msg | String | NO | The result message. |\n| avatar | String | NO | User avatar image url. |\n| nickName | String | NO | User nickName. |\n| gender | String | NO | User gender. \"m\" is male，\"f\" is female. |\n| countryCode | String | NO | The code of the country where user is located. it should follow [ISO 3166-1 alpha-2 code](https://www.iso.org/iso-3166-country-codes.html) standard, such as 'US', 'SG'. |\n| province | String | NO | The province where user is located. |\n| city | String | NO | The city where user is located. |\n\nThese fields are returned every time, but it will be an empty string if the app does not return the related information.\n\nThe maximum length of these fields are 128 bytes except avatar，the maximum length of avatar is 2048 bytes.\n\n## Sample Code\n\ncopy\n\n```html\n<!-- .axml -->\n<button\n\ta:if=\"{{canIUseAuthButton}}\"\n\topen-type=\"getAuthorize\"\n\tonGetAuthorize=\"onGetAuthorize\"\n    onError=\"onAuthError\"\n\tscope='userInfo'>\n</button>\n```\n\n### Button Property Description\n\n|     |     |\n| --- | --- |\n| **Name** | **Description** |\n| open-type | `getAuthorize`(Must be this value). |\n| scope | `userInfo`(Must be this value). |\n| onGetAuthorize | Authorization success callback (The Mini Program can call my.getOpenUserInfo to get information in this callback). |\n| onError | Authorization failure callback (Including user rejection and system exceptions). |\n\n### Get User Basic Information\n\nAfter the user clicks the consent, the user basic information can be obtained through my.getOpenUserInfo().\n\ncopy\n\n```javascript\n// .js\nonGetAuthorize(res) {\n    my.getOpenUserInfo({\n        fail: (res) => {\n        },\n        success: (res) => {\n            let userInfo = JSON.parse(res.response).response\n        }\n    });\n}\n```\n\n#### Return Res Object In the Success Callback\n\n- An example of a successfully res object returned is as follows:\n\ncopy\n\n```json\n{\n    \"response\": \"{\\\"response\\\": {\\\"code\\\": \\\"10000\\\",\\\"msg\\\": \\\"Success\\\",\\\"countryCode\\\": \\\"code\\\",\\\"gender\\\": \\\"f\\\",\\\"nickName\\\": \\\"XXX\\\",\\\"avatar\\\": \\\"https://cdn/images/partner/XXXXXXXX\\\",\\\"city\\\": \\\"city\\\",\\\"province\\\": \\\"province\\\"}}\"\n}\n```\n\n- If the function package of \"Get Basic User Information\" is not connected, the format example of returned res message is as follows:\n\ncopy\n\n```json\n{\n    \"response\":\"{\\\"response\\\":{\\\"code\\\":\\\"40006\\\",\\\"msg\\\":\\\"Insufficient Permissions\\\",\\\"subCode\\\":\\\"isv.insufficient-isv-permissions\\\",\\\"subMsg\\\": \\\"Insufficient permissions\\\"}}\"\n}\n```",
  "date": "2021-05-09",
  "source": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev-old/api_openapi_getopenuserinfo",
  "path": "miniprogram_gcash",
  "type": "miniprogram",
  "filename": "miniprogram.gcash.com_docs_miniprogram_gcash_mpdev-old_api_openapi_getopenuserinfo.json"
}