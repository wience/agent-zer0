{
  "title": "my.onMemoryWarning",
  "content": "# my.onMemoryWarning\n\n2022-07-03 18:44\n\nUse this API to listen to the insufficient memory alarm event.\n\nFor Android, two alarm levels exist:\n\n- `TRIM_MEMORY_RUNNING_LOW`\n\n- `TRIM_MEMORY_RUNNING_CRITICAL`\n\nNo alarm level is available for iOS.\n\n## Sample Code\n\ncopy\n\n```json\n// API-DEMO page/API/memory-warning/memory-warning.json\n{\n   \"defaultTitle\": \"OnMemoryWarning\"\n}\n```\n\ncopy\n\n```html\n<!-- API-DEMO page/API/memory-warning/memory-warning.axml-->\n<view class=\"page\">\n\n  <button type=\"primary\" onTap=\"onMemoryWarning\">\n    Listen to Insufficient Memory Alarm Event\n  </button>\n\n</view>\n```\n\ncopy\n\n```javascript\n// API-DEMO page/API/memory-warning/memory-warning.js\nPage({\n  onLoad() {\n    this.callback = (res) => {\n        var levelString = 'iOS device, No alarm level exists.';\n        switch (res.level) {\n          case 10:\n            levelString = 'Android device, level = TRIM_MEMORY_RUNNING_LOW';\n            break;\n          case 15:\n            levelString = 'Android device, level = TRIM_MEMORY_RUNNING_CRITICAL';\n            break;\n        }\n        my.alert({\n          title: 'Received insufficient memory alarm',\n          content: levelString\n        });\n    };\n    this.isApiAvailable = my.canIUse('onMemoryWarning');\n  },\n  onMemoryWarning() {\n    if (this.isApiAvailable) {\n      my.onMemoryWarning(this.callback);\n    } else {\n      my.alert({\n        title: 'Client version is too low',\n        content: 'my.onMemoryWarning() and my.offMemoryWarning() need 10.1.35 or higher versions'\n      });\n    }\n  },\n  onUnload() {\n    if (this.isApiAvailable) {\n      my.offMemoryWarning(this.callback);\n    }\n  }\n});\n```\n\n## Parameters\n\nThe property is a callback function which uses object properties with the following property:\n\n|     |     |     |\n| --- | --- | --- |\n| **Property** | **Type** | **Description** |\n| level | Number | Memory alarm level, only available in Android. |\n\nAndroid alarm levels that correspond to the system macro definitions:\n\ncopy\n\n```\nint TRIM_MEMORY_RUNNING_LOW = 10\nint TRIM_MEMORY_RUNNING_CRITICAL = 15\n```\n\n九色鹿",
  "date": "2022-07-03",
  "source": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_device_memory-warning_onmemorywarning",
  "path": "miniprogram_gcash",
  "type": "miniprogram",
  "filename": "miniprogram.gcash.com_docs_miniprogram_gcash_mpdev_api_device_memory-warning_onmemorywarning.json"
}