{
  "title": "User information capability",
  "content": "# User information capability\n\n2022-07-03 18:44\n\nAll the user information on the Mini Program Platform requires user's authorization. Based on the industry standard OAuth2.0 authorization mechanism, mini program developers can get user authorization to obtain user information.\n\n**Note**: Developers must fully respect the privacy of users and properly use the user authorization. If the information is found to be used beyond the agreed scope or reasonable usage, the platform has the right to permanently withdraw the interface authority of mini program.\n\n# Prerequisites\n\n- This capability is open to merchants who have become business partners of the wallet.\n- Make sure that the integration and configuration have been completed and the mini program has been released.\n\n# Interaction process\n\n## Silence mode\n\nThe silence mode requires the user's consent on a native app to collect the required information. The interaction flow of the silence mode is illustrated as below:\n\n![MP best practice for payment.jpg](https://yuque.antfin.com/images/lark/0/2020/jpeg/276536/1602663281142-406e8436-d47f-47ab-9cf6-c9da9b415281.jpeg)\n\n1. The user opens the wallet app and is redirected to the merchant mini program.\n2. The merchant mini program calls the `getAuthCode` JSAPI to request `authCode` from the wallet app.\n3. The wallet app returns `authCode` to the merchant mini program, which sends `authCode` to the ISV or merchant server.\n4. With the obtained `authCode` in step 3, the ISV or merchant server calls the `/{version}/oauths/applyToken` OpenAPI to request `accessToken` and `uid` from the wallet server.\n\nNote: The `version` is the version of Open APIs, for example, `v1` or `v2`.\n\n5. The wallet server returns `accessToken` and `uid` to the ISV or merchant server.\n\n**Notes:**\n\n- `authCode` is used to exchange for `accessToken`. Every time the user authorization is completed, `authCode` in the JSAPI response is different. `authCode` can only be used once and will automatically expire within one day.\n- After the ISV or merchant obtains `accessToken` and `uid`:\n\n- The ISV or merchant can use `accessToken` to call other OpenAPIs. For example, call the `inquiryUserInfoByAccessToken` OpenAPI to query the user information.\n- The ISV or merchant can generate a **session** that maps to `accessToken` and `uid`, then set session expiration time and store the mapping. The session will be stored in the mini program framework.\n\n## User consent mode\n\nThe user consent mode is used to get public user information without further permission from wallets. The interaction flow of the user consent mode is illustrated as below:\n\n![MP best practice for payment2.jpg](https://yuque.antfin.com/images/lark/0/2020/jpeg/276536/1602663312637-8457da51-f6f2-4c3c-9db1-1d7b79f6e042.jpeg)\n\n**Get user open info**\n\nWhen the merchant mini program intends to get some public information of users, such as name and avatar, use the user consent mode with the `getOpenUserInfo` JSAPI. The user needs to sign the agreement and clicks the **Accept** button. This function is used to display some personal data of the user in the mini program.\n\n**Get auth code**\n\nWhen the merchant mini program intends to get `authCode` for further usage, call the `getAuthCode` JSAPI by specifying the `scope` field.\n\n# API list\n\n|     |     |\n| --- | --- |\n| **JSAPI** | **Description** |\n| [my.getOpenUserInfo](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_getopenuserinfo) | Gets user basic information, such as avatar, nickname, etc. |\n| [my.getAuthCode](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_getauthcode) | Gets user's authentication code. |\n| **OpenAPI** | **Description** |\n| `/{version}/authorizations/{apiName}`<br>Note: The `version` is the version of Open APIs, for example, `v1` or `v2`. | For details, see the [Open APIs for Merchants](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/openapi_overview) chapter. |\n| [/{version}/users/inquiryUserInfo](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/v2_users_inquiryuserinfo) |\n\n# More information\n\n[Capabilities](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/capabilities)\n\n[JSAPIs](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_overview)\n\n[Open APIs](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/openapi_overview)\n\n[Developing Mini Program](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/developer-guide)\n\n[Using Mini Program Platform](https://miniprogram.gcash.com/docs/miniprogram_gcash/platform/overview)\n\n[Features](https://miniprogram.gcash.com/docs/miniprogram_gcash/platform/feature)",
  "date": "2022-07-03",
  "source": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/capability-user-information",
  "path": "miniprogram_gcash",
  "type": "miniprogram",
  "filename": "miniprogram.gcash.com_docs_miniprogram_gcash_mpdev_capability-user-information.json"
}