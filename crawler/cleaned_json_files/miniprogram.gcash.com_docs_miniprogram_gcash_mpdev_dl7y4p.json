{
  "title": "/v1/payments/inquiryPayment",
  "content": "# /v1/payments/inquiryPayment\n\n2022-07-03 18:44\n\nPOST `/v1/payments/inquiryPayment`\n\nThe `inquiryPayment` API is used to inquire the payment result, usually when not able to receive the payment result after a long period of time. Such as:\n\n**Note:**\n\n1) After Merchant initiates payment and not able to receive the payment result after a long period of time, it can poll Payment Status Inquiry interface.\n\n2) Merchant uses InquiryPayment to determine the Payment status in the asynchronous Payment processing scenario.\n\nRound-robin interval, recommended 5s once, up to 1 minute.\n\n# Message structure\n\n## Request\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **Property** | **Data type** | **Required** | **Description** |\n| partnerId | String | Yes | The partnerId allocated by wallet.<br>Max. length: 32 characters. |\n| paymentId | String | No | The unqiue ID of a payment generated by Wallet.<br>Max. length: 64 characters. |\n| paymentRequestId | String | No | The unqiue ID of a payment generated by Wallet merchants.<br>Max. length: 64 characters. |\n| extendInfo | String | No | The extend information,wallet and merchant can put extend info here.<br>Max. length: 4096 characters. |\n\n## Response\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **Property** | **Data type** | **Required** | **Description** |\n| result | [**Result**](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/vs3pkf#sHXZc) | Yes | The request result, which contains information related to the request result, such as status and error codes. |\n| paymentId | String | No | The unqiue ID of a payment generated by Wallet.<br>Max. length: 64 characters. |\n| paymentRequestId | String | No | The unqiue ID of a payment generated by Wallet merchants.<br>Max. length: 64 characters. |\n| paymentAmount | [**Amount**](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/vs3pkf#2umUE) | No | Order amount for display of user consumption records, payment results page. |\n| paymentTime | String/Datetime | No | Payment success time, which follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard. |\n| paymentStatus | String | No | SUCCESS - order is succeeded.<br>FAIL - order is failed.<br>PROCESSING - order is not paid or is paid but not finish.<br>CANCELLED - order is cancelled. |\n| paymentFailReason | String | No | The fail reason of payment order when paymentStatus is FAIL.<br>Max. length: 256 characters. |\n| authExpiryTime | String/Datetime | No | Authorization expiry time, has value only when paymentFactor.isAuthorizationPayment is true. |\n| extendInfo | String | No | The extend information,wallet and merchant can put extend info here.<br>Max. length: 4096 characters. |\n\n### Result Process Logic\n\nFor different request results, different actions are to be performed. See the following list for details:\n\n- If the value of **result.resultStatus** is **S**, that means the payment status inquiry is successful, then check **paymentStatus**:\n\n- if **paymentStatus** is **PROCESSING**, means order is not paid or is paid but not finish;\n- if **paymentStatus** is **SUCCESS**, means order is succeeded;\n- if **paymentStatus** is **FAIL**, means order is failed.\n-  if **paymentStatus** is **CANCELLED**, means order is cancelled.\n\n- If the value of **result.resultStatus** is **F**, that means the payment status inquiry is fail. When **resultCode** is **ORDER\\_NOT\\_EXIST**, it means that the payment is not yet accepted and can be treated as payment failure. For the other failure reason, human intervention is recommended.\n- If the value of **result.resultStatus** is **U**, that means unknown exception occur on wallet side, merchant may try again.\n\n### Result\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **No** | **resultStatus** | **resultCode** | **resultMessage** |\n| 1 | S | SUCCESS | Success. |\n| 2 | U | UNKNOWN\\_EXCEPTION | An API calling is failed, which is caused by unknown reasons. |\n| 3 | U | REQUEST\\_TRAFFIC\\_EXCEED\\_LIMIT | The request traffic exceeds the limit. |\n| 4 | F | ORDER\\_NOT\\_EXIST | The order doesn't exist. |\n| 5 | F | INVALID\\_API | The called API is invalid or not active. |\n| 6 | F | PARAM\\_ILLEGAL | Illegal parameters. For example, non-numeric input, invalid date. |\n| 7 | F | PROCESS\\_FAIL | A general business failure occurred. Don't retry. |\n| 8 | F | ACCESS\\_DENIED | The access is denied. |\n| 9 | F | EXPIRED\\_AGENT\\_TOKEN | The access token of mini program is expired. |\n| 10 | F | INVALID\\_AGENT\\_TOKEN | The access token of mini program is invalid. |\n\n# Sample\n\nExample: A Russian user (Bob) bought a 100 USD product on the e-commerce platform, paid by credit card and submitted the payment synchronously, asynchronous polling payment results.\n\n![/v1/payments/inquiryPayment](https://ac.alipay.com/storage/2020/5/11/793a3d8d-5270-405b-9362-e6a670b9c842.png)\n\n1. The Mini Program calls my.tradePay interface to do payment (Step 1).\n2. E-wallet App returns payment result to the Mini Program (Step 5).\n3. Also e-wallet notifies the payment result with paymentNotifyUrl provided by merchant (Step 4).\n4. Besides the merchant could call /v1/payments/inquiryPayment interface to query the payment result (Step 6).\n5. E-wallet will return payment status inquiry result to the merchant server (step 7).\n\n## Request\n\n**A. Inquiry By paymentRequestId**\n\ncopy\n\n```json\n{\n \"paymentRequestId\":\"1022172000000000001xxxx\",\n \"partnerId\":\"20200101234567890132xxxx\",\n \"extendInfo\": \"{\\\"customerBelongsTo\\\":\\\"siteNameExample\\\"}\"\n}\n```\n\n**B. Inquiry By paymentId**\n\ncopy\n\n```json\n{\n \"paymentId\":\"1022172000000000001xxxx\",\n \"partnerId\":\"20200101234567890132xxxx\",\n \"extendInfo\": \"{\\\"customerBelongsTo\\\":\\\"siteNameExample\\\"}\"\n}\n```\n\n- **paymentId** the unique Id of a payment generated by Wallet.\n- **paymentRequestId** the unique Id of a payment generated by Wallet merchants.\n- **partnerId** the partnerId allocated by Wallet.\n- **extendInfo,** includes key - **customerBelongsTo** the e-wallet that the customer uses. Corresponding to the field 'siteName' that obtained from the API 'my.getSiteInfo', in the Mini Program scenario this is mandatory.\n\n**Note:**\n\nThis interface support querying with **paymentId** or **paymentRequestId**. **paymentId** has a higher priority than **paymentRequestId**, which means that if you offer both **paymentId** and **paymentRequestId**, we will use **paymentId** and ignore **paymentRequestId**.\n\n## Response\n\ncopy\n\n```json\n{\n \"result\": {\n    \"resultCode\":\"SUCCESS\",\n    \"resultStatus\":\"S\",\n    \"resultMessage\":\"success\"\n  },\n \"paymentId\":\"20200101234567890133333xxxx\",\n \"paymentRequestId\":\"20200101234567890133333xxxx\",\n \"paymentTime\": \"2020-01-01T12:01:01+08:30\",\n \"paymentAmount\":{\n    \"value\":\"100\",\n    \"currency\":\"USD\"\n },\n \"paymentStatus\":\"SUCCESS\"\n}\n```\n\n- **result** **.** **resultStatus==S** shows that the inquiry is successful.\n- **paymentId** the unique Id of a payment generated by Wallet.\n- **paymentRequestId** the unique Id of a payment generated by Wallet merchants.\n- **paymentTime** describes the date time of the successful Wallet payment.\n- **paymentAmount** describes the payment amount.\n- **paymentStatus** describes the payment status.\n\n- **paymentStatus.PROCESSING** order is not paid or is paid but not finish.\n- **paymentStatus.SUCCESS** order is succeeded.\n- **paymentStatus.FAIL** order is failed.\n- **paymentStatus.CANCELLED** order is cancelled.\n\n- **paymentFailReason** describes the payment fail reason when **paymentStatus=** **FAIL.**\n- **authExpiryTime** describes the payment authorization expiry time, when payment order is **paymentFactor.isAuthorizationPayment=true.**",
  "date": "2022-07-03",
  "source": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/dl7y4p",
  "path": "miniprogram_gcash",
  "type": "miniprogram",
  "filename": "miniprogram.gcash.com_docs_miniprogram_gcash_mpdev_dl7y4p.json"
}