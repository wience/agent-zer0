{
  "title": "/v1/payments/notifyPayment",
  "content": "# /v1/payments/notifyPayment\n\n2022-07-03 18:44\n\nPOST `/v1/payments/notifyPayment`\n\nThe `notifyPayment` API is used to notify  payment result to merchant/partner.\n\n**Note:**\n\n1) to notify merchant/partner the payment result when  payment processing reaches the final state (Success/Fail).\n\n2) Not all scenario merchant/partner need receive this notify. Such as sync payment scenario(B Scan C, Agreement Pay).\n\n# Message structure\n\n## Request\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **Property** | **Data type** | **Required** | **Description** |\n| partnerId | String | Yes | The partnerId allocated by wallet.<br>Max. length: 32 characters. |\n| paymentId | String | Yes | The unqiue ID of a payment generated by Wallet.<br>Max. length: 64 characters. |\n| paymentRequestId | String | Yes | The unqiue ID of a payment generated by Wallet merchants.<br>Max. length: 64 characters. |\n| paymentAmount | [**Amount**](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/vs3pkf#2umUE) | Yes | Order amount for display of user consumption records, payment results page. |\n| paymentTime | String/Datetime | No | Payment success time, which follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard. |\n| paymentStatus | String | Yes | `SUCCESS` \\- order is succeeded.<br>`FAIL` \\- order is failed. |\n| paymentFailReason | String | No | The fail reason of payment order when paymentStatus is FAIL.<br>Max. length: 256 characters. |\n| extendInfo | String | No | The extend information,wallet and merchant can put extend info here.<br>Max. length: 4096 characters. |\n\n## Response\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **Property** | **Data type** | **Required** | **Description** |\n| result | [**Result**](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/vs3pkf#sHXZc) | Yes | The request result, which contains information related to the request result, such as status and error codes. |\n\n### Result Process Logic\n\n- If result.resultStatus == S, Means the merchant/partner already received this notification.\n- If result.resultStatus == F, it means merchant/partner handle this notification failed.\n- If result.resultStatus==U, it means merchant/partner handle this notification occur unknown exception, wallet will retry if get U response.\n- If other response (almost never occur),wallet will process like U.\n\n### Result\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| **No** | **resultStatus** | **resultCode** | **resultMessage** |\n| 1 | S | SUCCESS | Success. |\n| 2 | U | UNKNOWN\\_EXCEPTION | An API calling is failed, which is caused by unknown reasons. |\n| 3 | U | REQUEST\\_TRAFFIC\\_EXCEED\\_LIMIT | The request traffic exceeds the limit. |\n| 4 | F | REPEAT\\_REQ\\_INCONSISTENT | Repeated submit, and requests are inconsistent. |\n| 5 | F | PROCESS\\_FAIL | A general business failure occurred. Don't retry. |\n| 6 | F | INVALID\\_API | The called API is invalid or not active. |\n| 7 | F | PARAM\\_ILLEGAL | Illegal parameters. For example, non-numeric input, invalid date. |\n\n# Sample\n\n![/v1/payments/notifyPayment](https://ac.alipay.com/storage/2020/5/11/793a3d8d-5270-405b-9362-e6a670b9c842.png)\n\n1. The Mini Program calls my.tradePay interface to do payment (Step 1).\n2. E-wallet App returns payment result to the Mini Program (Step 5).\n3. E-wallet notifies the payment result with paymentNotifyUrl provided by merchant (Step 4).\n\nFor example, a wallet user purchases a 100 USD merchandise at a  merchant/partner, after user finished payment in wallet cashier page, wallet will send payment status notification to merchant/partner.\n\n## Payment\n\n**A. Request sample with payment success**\n\ncopy\n\n```json\n{\n  \"partnerId\": \"P000000000000001xxxx\",\n  \"paymentId\": \"201911271907410100070000009999xxxx\",\n  \"paymentRequestId\": \"2019112719074101000700000088881xxxx\",\n  \"paymentAmount\": {\n    \"currency\": \"USD\",\n    \"value\": \"10000\"\n  },\n  \"paymentTime\": \"2019-11-27T12:02:01+08:30\",\n  \"paymentStatus\": \"SUCCESS\"\n}\n```\n\n- **partnerId** is the idetifier of a merchant/partner, allocated by Wallet.\n- **paymentId** is generated by Wallet, uniquely identifies the payment.\n- **paymentRequestId** is generated by merchan _t/partner,_ uniquely identifies this payment. In payment notify request, paymentRequestId should be the paymentRequestId in origin payment request.\n- **paymentAmount** describes the amount of 100 USD already collected by Wallet from user account for this payment.\n- **paymentTime** is the success date time of this transaction.\n- **paymentStatus** is the payment status in wallet. SUCCESS means transaction already success.\n\n**B.**\n\ncopy\n\n```json\n{\n  \"partnerId\": \"P000000000000001xxxx\",\n  \"paymentId\": \"201911271907410100070000009999xxxx\",\n  \"paymentRequestId\": \"2019112719074101000700000088881xxxx\",\n  \"paymentAmount\": {\n    \"currency\": \"USD\",\n    \"value\": \"10000\"\n  },\n  \"paymentCreateTime\": \"2019-11-27T12:01:01+08:30\",\n  \"paymentTime\": \"2019-11-27T12:02:01+08:30\",\n  \"paymentStatus\": \"FAIL\",\n  \"paymentFailReason\":\"Order payment expired.\"\n}\n```\n\n- **paymentStatus** is the payment status in wallet. FAIL means this transaction already failed, usually payment fail are because of this payment already expired .\n- **paymentFailReason** used to fill the payment fail reason, only payment status is FAIL will return this parameter.\n\n## Response\n\ncopy\n\n```json\n{\n \"result\": {\n    \"resultCode\":\"SUCCESS\",\n    \"resultStatus\":\"S\",\n    \"resultMessage\":\"success\"\n  }\n }\n```\n\n- **result.resultStatus==S**  shows that merchant/partner already received this notification.",
  "date": "2022-07-03",
  "source": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/edgctc",
  "path": "miniprogram_gcash",
  "type": "miniprogram",
  "filename": "miniprogram.gcash.com_docs_miniprogram_gcash_mpdev_edgctc.json"
}