{
  "markdown": "# my.offBLEConnectionStateChanged\n\n2022-07-03 18:44\n\nUse this API to unlisten to the Bluetooth Low Energy (BLE) connection status change event.\n\n**Instruction:**\n\nIt is recommended that you call the `off` method and close event listening before you call the `on` method to listen events to prevent the situation where multiple listening event cause multiple callbacks of an event.\n\n**Note:**\n\nCurrently simulation in IDE is not supported. Please debug in production environment.\n\n## Sample Code\n\ncopy\n\n```css\n/* .acss */\n.help-info {\n  padding:10px;\n  color:#000000;\n}\n.help-title {\n  padding:10px;\n  color:#FC0D1B;\n}\n```\n\ncopy\n\n```json\n// .json\n{\n    \"defaultTitle\": \"Bluetooth\"\n}\n```\n\ncopy\n\n```html\n<!-- .axml-->\n<view class=\"page\">\n  <view class=\"page-description\">Bluetooth API</view>\n  <view class=\"page-section\">\n    <view class=\"page-section-title\">The Bluetooth state</view>\n    <view class=\"page-section-demo\">\n       <button type=\"primary\" onTap=\"openBluetoothAdapter\">Initialize Bluetooth</button>\n       <button type=\"primary\" onTap=\"closeBluetoothAdapter\">Close Bluetooth</button>\n       <button type=\"primary\" onTap=\"getBluetoothAdapterState\">Obtain Bluetooth state</button>\n    </view>\n    <view class=\"page-section-title\">Scan the Bluetooth device</view>\n    <view class=\"page-section-demo\">\n       <button type=\"primary\" onTap=\"startBluetoothDevicesDiscovery\">Start searching</button>\n       <button type=\"primary\" onTap=\"getBluetoothDevices\">All devices found</button>\n       <button type=\"primary\" onTap=\"getConnectedBluetoothDevices\">All devices connected</button>\n       <button type=\"primary\" onTap=\"stopBluetoothDevicesDiscovery\">Stop searching</button>\n    </view>\n    <view class=\"page-section-title\">Connect the device</view>\n    <view class=\"page-section-demo\">\n       <input class=\"input\" onInput=\"bindKeyInput\" type=\"{{text}}\" placeholder=\"Enter the device ID of the device to connect\"></input>\n       <button type=\"primary\" onTap=\"connectBLEDevice\">Connect the device</button>\n       <button type=\"primary\" onTap=\"getBLEDeviceServices\">Obtain device services</button>\n       <button type=\"primary\" onTap=\"getBLEDeviceCharacteristics\">Obtain read and write characteristics</button>\n       <button type=\"primary\" onTap=\"disconnectBLEDevice\">Disconnect the device</button>\n    </view>\n     <view class=\"page-section-title\">Read and write data</view>\n     <view class=\"page-section-demo\">\n       <button type=\"primary\" onTap=\"notifyBLECharacteristicValueChange\">Listens to the characteristic data change</button>\n       <button type=\"primary\" onTap=\"readBLECharacteristicValue\">Read data</button>\n       <button type=\"primary\" onTap=\"writeBLECharacteristicValue\">Write data</button>\n       <button type=\"primary\" onTap=\"offBLECharacteristicValueChange\">Un-listens to characteristic value</button>\n    </view>\n     <view class=\"page-section-title\">Other events</view>\n     <view class=\"page-section-demo\">\n       <button type=\"primary\" onTap=\"bluetoothAdapterStateChange\">Changes of the Bluetooth state</button>\n       <button type=\"primary\" onTap=\"offBluetoothAdapterStateChange\">Un-listens to Bluetooth state</button>\n       <button type=\"primary\" onTap=\"BLEConnectionStateChanged\">Changes of Bluetooth connection state</button>\n       <button type=\"primary\" onTap=\"offBLEConnectionStateChanged\">Un-listens to Bluetooth connection state</button>\n    </view>\n  </view>\n</view>\n```\n\ncopy\n\n```javascript\n// .js\nPage({\n  data: {\n    devid: '0D9C82AD-1CC0-414D-9526-119E08D28124',\n    serid: 'FEE7',\n    notifyId: '36F6',\n    writeId: '36F5',\n    charid: '',\n    alldev: [{ deviceId: '' }],\n  },\n\n  //Obtain the Bluetooth state\n  openBluetoothAdapter() {\n    my.openBluetoothAdapter({\n      success: res => {\n        if (!res.isSupportBLE) {\n          my.alert({ content: 'Sorry, your mobile Bluetooth is unavailable temporarily' });\n          return;\n        }\n        my.alert({ content: 'Succeeded to initialize!' });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n  closeBluetoothAdapter() {\n    my.closeBluetoothAdapter({\n      success: () => {\n        my.alert({ content: 'Bluetooth closed!' });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n  getBluetoothAdapterState() {\n    my.getBluetoothAdapterState({\n      success: res => {\n        if (!res.available) {\n          my.alert({ content: 'Sorry, your mobile Bluetooth is unavailable temporarily' });\n          return;\n        }\n        my.alert({ content: JSON.stringify(res) });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n\n  //Scan the Bluetooth device\n  startBluetoothDevicesDiscovery() {\n    my.startBluetoothDevicesDiscovery({\n      allowDuplicatesKey: false,\n      success: () => {\n        my.onBluetoothDeviceFound({\n          success: res => {\n            // my.alert({content:'Listens to new device'+JSON.stringify(res)});\n            var deviceArray = res.devices;\n            for (var i = deviceArray.length - 1; i >= 0; i--) {\n              var deviceObj = deviceArray[i];\n              //Pair the target device with the device name or broadcast data, and then record the device ID for later use.\n              if (deviceObj.name == this.data.name) {\n                my.alert({ content: 'Target device is found' });\n                my.offBluetoothDeviceFound();\n                this.setData({\n                  deviceId: deviceObj.deviceId,\n                });\n                break;\n              }\n            }\n          },\n          fail: error => {\n            my.alert({ content: 'Failed to listen to new device' + JSON.stringify(error) });\n          },\n        });\n      },\n      fail: error => {\n        my.alert({ content: 'Failed to start scanning' + JSON.stringify(error) });\n      },\n    });\n  },\n\n  //Stop scanning\n  stopBluetoothDevicesDiscovery() {\n    my.stopBluetoothDevicesDiscovery({\n      success: res => {\n        my.offBluetoothDeviceFound();\n        my.alert({ content: 'Succeeded!' });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n\n  //Obtain the connected device\n  getConnectedBluetoothDevices() {\n    my.getConnectedBluetoothDevices({\n      success: res => {\n        if (res.devices.length === 0) {\n          my.alert({ content: 'No connecting devices!' });\n          return;\n        }\n        my.alert({ content: JSON.stringify(res) });\n        devid = res.devices[0].deviceId;\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n\n  //Obtain all searched devices\n  getBluetoothDevices() {\n    my.getBluetoothDevices({\n      success: res => {\n        my.alert({ content: JSON.stringify(res) });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n  bindKeyInput(e) {\n    this.setData({\n      devid: e.detail.value,\n    });\n  },\n\n  //Connect the device\n  connectBLEDevice() {\n    my.connectBLEDevice({\n      deviceId: this.data.devid,\n      success: res => {\n        my.alert({ content: 'Succeeded to connect!' });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n\n  //Disconnect the device\n  disconnectBLEDevice() {\n    my.disconnectBLEDevice({\n      deviceId: this.data.devid,\n      success: () => {\n        my.alert({ content: 'Succeeded to disconnect!' });\n      },\n      fail: error => {\n        my.alert({ content: JSON.stringify(error) });\n      },\n    });\n  },\n\n  //Obtain the services of the connected device\n  getBLEDeviceServices() {\n    my.getConnectedBluetoothDevices({\n      success: res => {\n        if (res.devices.length === 0) {\n          my.alert({ content: 'No connected devices' });\n          return;\n        }\n        my.getBLEDeviceServices({\n          deviceId: this.data.devid,\n          success: res => {\n            my.alert({ content: JSON.stringify(res) });\n            this.setData({\n              serid: res.services[0].serviceId,\n            });\n          },\n          fail: error => {\n            my.alert({ content: JSON.stringify(error) });\n          },\n        });\n      },\n    });\n  },\n\n  //Obtain the char ID of the connected device, read and write characteristics are respectively screened out.\n  getBLEDeviceCharacteristics() {\n    my.getConnectedBluetoothDevices({\n      success: res => {\n        if (res.devices.length === 0) {\n          my.alert({ content: 'No connected devices' });\n          return;\n        }\n        this.setData({\n          devid: res.devices[0].deviceId,\n        });\n        my.getBLEDeviceCharacteristics({\n          deviceId: this.data.devid,\n          serviceId: this.data.serid,\n          success: res => {\n            my.alert({ content: JSON.stringify(res) });\n            //See the related document for more information of the properties of the characteristics. Pair the characteristics according to the properties and record the value for later use.\n            this.setData({\n              charid: res.characteristics[0].characteristicId,\n            });\n          },\n          fail: error => {\n            my.alert({ content: JSON.stringify(error) });\n          },\n        });\n      },\n    });\n  },\n\n  //Read and write data\n  readBLECharacteristicValue() {\n    my.getConnectedBluetoothDevices({\n      success: res => {\n        if (res.devices.length === 0) {\n          my.alert({ content: 'No connected devices' });\n          return;\n        }\n        this.setData({\n          devid: res.devices[0].deviceId,\n        });\n        my.readBLECharacteristicValue({\n          deviceId: this.data.devid,\n          serviceId: this.data.serid,\n          characteristicId: this.data.notifyId,\n          //1、Android reading service\n          // serviceId:'0000180d-0000-1000-8000-00805f9b34fb',\n          // characteristicId:'00002a38-0000-1000-8000-00805f9b34fb',\n          success: res => {\n            my.alert({ content: JSON.stringify(res) });\n          },\n          fail: error => {\n            my.alert({ content: 'Failed to read' + JSON.stringify(error) });\n          },\n        });\n      },\n    });\n  },\n  writeBLECharacteristicValue() {\n    my.getConnectedBluetoothDevices({\n      success: res => {\n        if (res.devices.length === 0) {\n          my.alert({ content: 'No connected devices' });\n          return;\n        }\n        this.setData({\n          devid: res.devices[0].deviceId,\n        });\n        my.writeBLECharacteristicValue({\n          deviceId: this.data.devid,\n          serviceId: this.data.serid,\n          characteristicId: this.data.charid,\n          //Android writing service\n          //serviceId:'0000180d-0000-1000-8000-00805f9b34fb',\n          //characteristicId:'00002a39-0000-1000-8000-00805f9b34fb',\n          value: 'ABCD',\n          success: res => {\n            my.alert({ content: 'Succeeded to write data!' });\n          },\n          fail: error => {\n            my.alert({ content: JSON.stringify(error) });\n          },\n        });\n      },\n    });\n  },\n  notifyBLECharacteristicValueChange() {\n    my.getConnectedBluetoothDevices({\n      success: res => {\n        if (res.devices.length === 0) {\n          my.alert({ content: 'No connected devices' });\n          return;\n        }\n        this.setData({\n          devid: res.devices[0].deviceId,\n        });\n        my.notifyBLECharacteristicValueChange({\n          state: true,\n          deviceId: this.data.devid,\n          serviceId: this.data.serid,\n          characteristicId: this.data.notifyId,\n          success: () => {\n            //Listens to characteristic change events\n            my.onBLECharacteristicValueChange({\n              success: res => {\n                //  my.alert({content: 'Changes of characteristics：'+JSON.stringify(res)});\n                my.alert({ content: 'Obtain the response data = ' + res.value });\n              },\n            });\n            my.alert({ content: 'Succeeded to listen' });\n          },\n          fail: error => {\n            my.alert({ content: 'Failed to listen' + JSON.stringify(error) });\n          },\n        });\n      },\n    });\n  },\n  offBLECharacteristicValueChange() {\n    my.offBLECharacteristicValueChange();\n  },\n\n  //Other events\n  bluetoothAdapterStateChange() {\n    my.onBluetoothAdapterStateChange(this.getBind('onBluetoothAdapterStateChange'));\n  },\n  onBluetoothAdapterStateChange() {\n    if (res.error) {\n      my.alert({ content: JSON.stringify(error) });\n    } else {\n      my.alert({ content: 'Changes of the Bluetooth state：' + JSON.stringify(res) });\n    }\n  },\n  offBluetoothAdapterStateChange() {\n    my.offBluetoothAdapterStateChange(this.getBind('onBluetoothAdapterStateChange'));\n  },\n  getBind(name) {\n    if (!this[`bind${name}`]) {\n      this[`bind${name}`] = this[name].bind(this);\n    }\n    return this[`bind${name}`];\n  },\n  BLEConnectionStateChanged() {\n    my.onBLEConnectionStateChanged(this.getBind('onBLEConnectionStateChanged'));\n  },\n  onBLEConnectionStateChanged(res) {\n    if (res.error) {\n      my.alert({ content: JSON.stringify(error) });\n    } else {\n      my.alert({ content: 'Changes of connection state：' + JSON.stringify(res) });\n    }\n  },\n  offBLEConnectionStateChanged() {\n    my.offBLEConnectionStateChanged(this.getBind('onBLEConnectionStateChanged'));\n  },\n  onUnload() {\n    this.offBLEConnectionStateChanged();\n    this.offBLECharacteristicValueChange();\n    this.offBluetoothAdapterStateChange();\n    this.closeBluetoothAdapter();\n  },\n});\n```\n\n## Whether to pass callback value or not\n\n- If the callback value is not passed, the callbacks of all events will be removed. The sample code is as follows:\n\ncopy\n\n```\nmy.offBLEConnectionStateChanged();\n```\n\n- If the callback value is passed, only the corresponding callback is removed. The sample code is as follows:\n\ncopy\n\n```\nmy.offBLEConnectionStateChanged(this.callback);\n```\n\n[iframe](https://tracert.alipay.com/cross.html)",
  "metadata": {
    "keywords": "",
    "og:title": "my.offBLEConnectionStateChanged | Developer's Guide | Documentation",
    "ogDescription": "Use this API to unlisten to the Bluetooth Low Energy (BLE) connection status change event.",
    "og:image": "",
    "og:description": "Use this API to unlisten to the Bluetooth Low Energy (BLE) connection status change event.",
    "viewport": "width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover",
    "ogImage": "",
    "og:type": "website",
    "ogUrl": "",
    "title": "my.offBLEConnectionStateChanged | Developer's Guide | Documentation",
    "robots": "noarchive",
    "og:url": "",
    "favicon": "https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*rOH-T5TEL-cAAAAAAAAAAABkARQnAQ",
    "description": "Use this API to unlisten to the Bluetooth Low Energy (BLE) connection status change event.",
    "ogTitle": "my.offBLEConnectionStateChanged | Developer's Guide | Documentation",
    "scrapeId": "1e7334b1-7b8f-441d-baed-20a0806b86fe",
    "sourceURL": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_device_bluetooth_ble_offbleconnectionstatechanged",
    "url": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_device_bluetooth_ble_offbleconnectionstatechanged",
    "statusCode": 200
  },
  "html": "<!DOCTYPE html><html style=\"--vh: 1000px;\" data-theme=\"light\">\n    <body>\n    \n    \n    <div id=\"root\"><div class=\"index-module_height100__dDLuI\"><div style=\"top:0\"></div><div class=\"styles-module_searchWrap__mIEtV index-module_mobileSearch__Lianv \"><svg class=\"icon icon-search styles-module_searchIcon__2wekS\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z\"></path></svg><input type=\"text\" title=\"Press 's' to start the search\" placeholder=\"Search documentation\"><div class=\"styles-module_resultWrap__LQyY1 \"><div class=\"styles-module_result__6EDKs\"><div class=\"styles-module_resultScroll__x5srB\"></div></div><div class=\"styles-module_mask__naKUh\"></div></div></div><div class=\"undefined index-module_height100__dDLuI\"><div class=\"index-module_container__-pyWH    idocs-global-container  idocs-global-normal-container\"><div class=\"index-module_center__Kh8xX  idocs-global-index-center \" style=\"max-width: none; min-height: calc(var(--vh, 1vh) * 100 - 26px);\"><main class=\"index-module_main__2B9Eq    idocs-global-main-with-toc\" style=\"padding-left:264px;width:0\"><article class=\"index-module_content__6p5ch  idocs-global-content\"><div class=\"index-module_contentInner__KQHGJ idocs-global-content-inner\"><div class=\"styles-module_docBody__zUo8V\"><h1 class=\"styles-module_title__6bcTh styles-module_anchored__AxVRP \"><span class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span><span>my.offBLEConnectionStateChanged</span></span></h1><div class=\"styles-module_updateDate__1rqmL\"><time datetime=\"2022-07-03 18:44\" style=\"color: var(--font-color-third);\"><svg class=\"icon icon-clock\" width=\"1em\" height=\"1em\"><path d=\"M6.832 0C3.058 0 0 3.134 0 7s3.058 7 6.832 7 6.833-3.134 6.833-7-3.059-7-6.833-7zm4.152 11.253a5.835 5.835 0 01-1.867 1.29 5.695 5.695 0 01-2.285.473 5.717 5.717 0 01-2.284-.472 5.872 5.872 0 01-1.867-1.29 5.995 5.995 0 01-1.259-1.912A6.096 6.096 0 01.961 7c0-.812.155-1.6.46-2.34A6.032 6.032 0 012.68 2.746a5.835 5.835 0 011.866-1.29A5.706 5.706 0 016.832.984c.793 0 1.562.159 2.285.472.699.304 1.326.737 1.867 1.29.539.552.963 1.196 1.258 1.912.307.742.462 1.53.462 2.342s-.155 1.6-.46 2.34a5.998 5.998 0 01-1.26 1.913zM9.78 6.891H7.313V3.609a.486.486 0 00-.48-.492c-.266 0-.481.22-.481.492v3.282c0 .544.43.984.96.984h2.47c.265 0 .48-.22.48-.492a.486.486 0 00-.48-.492z\" fill=\"currentColor\" fill-rule=\"nonzero\" fill-opacity=\".7\"></path></svg>2022-07-03 18:44</time></div><div class=\"styles-module_content__2jcQS styles-module_yuqueContent__iJuXe\"><p>Use this API to unlisten to the Bluetooth Low Energy (BLE) connection status change event.</p><p><strong>Instruction:</strong><br>\nIt is recommended that you call the <code>off</code> method and close event listening before you call the <code>on</code> method to listen events to prevent the situation where multiple listening event cause multiple callbacks of an event.</p><p><strong>Note:</strong><br>\nCurrently simulation in IDE is not supported. Please debug in production environment.</p><a name=\"Sample-Code\"></a><h2 id=\"2d071c97\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"2d071c97\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span>Sample Code</h2><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code class=\"language-css\" style=\"white-space:pre\"><span style=\"color:#a0a1a7;font-style:italic\">/* .acss */</span><span>\n</span><span></span><span style=\"color:#986801\">.help-info</span><span> {\n</span><span>  </span><span style=\"color:#50a14f\">padding</span><span>:</span><span style=\"color:#986801\">10px</span><span>;\n</span><span>  </span><span style=\"color:#50a14f\">color</span><span>:</span><span style=\"color:#986801\">#000000</span><span>;\n</span>}\n<span></span><span style=\"color:#986801\">.help-title</span><span> {\n</span><span>  </span><span style=\"color:#50a14f\">padding</span><span>:</span><span style=\"color:#986801\">10px</span><span>;\n</span><span>  </span><span style=\"color:#50a14f\">color</span><span>:</span><span style=\"color:#986801\">#FC0D1B</span><span>;\n</span>}</code></pre></div><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code class=\"language-json\" style=\"white-space:pre\"><span style=\"color:#a0a1a7;font-style:italic\">// .json</span><span>\n</span>{\n<span>    </span><span style=\"color:#986801\">\"defaultTitle\"</span><span>: </span><span style=\"color:#50a14f\">\"Bluetooth\"</span><span>\n</span>}</code></pre></div><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code class=\"language-html\" style=\"white-space:pre\"><span>&lt;!-- .axml--&gt;\n</span><span>&lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page\"</span><span>&gt;\n</span><span>  &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-description\"</span><span>&gt;Bluetooth API&lt;/view&gt;\n</span><span>  &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section\"</span><span>&gt;\n</span><span>    &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-title\"</span><span>&gt;The Bluetooth state&lt;/view&gt;\n</span><span>    &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-demo\"</span><span>&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"openBluetoothAdapter\"</span><span>&gt;Initialize Bluetooth&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"closeBluetoothAdapter\"</span><span>&gt;Close Bluetooth&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"getBluetoothAdapterState\"</span><span>&gt;Obtain Bluetooth state&lt;/button&gt;\n</span>    &lt;/view&gt;\n<span>    &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-title\"</span><span>&gt;Scan the Bluetooth device&lt;/view&gt;\n</span><span>    &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-demo\"</span><span>&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"startBluetoothDevicesDiscovery\"</span><span>&gt;Start searching&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"getBluetoothDevices\"</span><span>&gt;All devices found&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"getConnectedBluetoothDevices\"</span><span>&gt;All devices connected&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"stopBluetoothDevicesDiscovery\"</span><span>&gt;Stop searching&lt;/button&gt;\n</span>    &lt;/view&gt;\n<span>    &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-title\"</span><span>&gt;Connect the device&lt;/view&gt;\n</span><span>    &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-demo\"</span><span>&gt;\n</span><span>       &lt;input </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"input\"</span><span> </span><span style=\"color:#50a14f\">onInput</span><span>=</span><span style=\"color:#50a14f\">\"bindKeyInput\"</span><span> </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"{{text}}\"</span><span> </span><span style=\"color:#50a14f\">placeholder</span><span>=</span><span style=\"color:#50a14f\">\"Enter the device ID of the device to connect\"</span><span>&gt;&lt;/input&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"connectBLEDevice\"</span><span>&gt;Connect the device&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"getBLEDeviceServices\"</span><span>&gt;Obtain device services&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"getBLEDeviceCharacteristics\"</span><span>&gt;Obtain read </span><span style=\"color:#a626a4\">and</span><span> write characteristics&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"disconnectBLEDevice\"</span><span>&gt;Disconnect the device&lt;/button&gt;\n</span>    &lt;/view&gt;\n<span>     &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-title\"</span><span>&gt;Read </span><span style=\"color:#a626a4\">and</span><span> write data&lt;/view&gt;\n</span><span>     &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-demo\"</span><span>&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"notifyBLECharacteristicValueChange\"</span><span>&gt;Listens </span><span style=\"color:#a626a4\">to</span><span> the characteristic data change&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"readBLECharacteristicValue\"</span><span>&gt;Read data&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"writeBLECharacteristicValue\"</span><span>&gt;Write data&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"offBLECharacteristicValueChange\"</span><span>&gt;Un-listens </span><span style=\"color:#a626a4\">to</span><span> characteristic value&lt;/button&gt;\n</span>    &lt;/view&gt;\n<span>     &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-title\"</span><span>&gt;Other events&lt;/view&gt;\n</span><span>     &lt;view </span><span style=\"color:#50a14f\">class</span><span>=</span><span style=\"color:#50a14f\">\"page-section-demo\"</span><span>&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"bluetoothAdapterStateChange\"</span><span>&gt;Changes of the Bluetooth state&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"offBluetoothAdapterStateChange\"</span><span>&gt;Un-listens </span><span style=\"color:#a626a4\">to</span><span> Bluetooth state&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"BLEConnectionStateChanged\"</span><span>&gt;Changes of Bluetooth</span><span style=\"color:#c18401\"> connection </span><span>state&lt;/button&gt;\n</span><span>       &lt;button </span><span style=\"color:#50a14f\">type</span><span>=</span><span style=\"color:#50a14f\">\"primary\"</span><span> </span><span style=\"color:#50a14f\">onTap</span><span>=</span><span style=\"color:#50a14f\">\"offBLEConnectionStateChanged\"</span><span>&gt;Un-listens </span><span style=\"color:#a626a4\">to</span><span> Bluetooth</span><span style=\"color:#c18401\"> connection </span><span>state&lt;/button&gt;\n</span>    &lt;/view&gt;\n<!-- -->  &lt;/view&gt;\n<!-- -->&lt;/view&gt;</code></pre></div><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code class=\"language-javascript\" style=\"white-space:pre\"><span style=\"color:#a0a1a7;font-style:italic\">// .js</span><span>\n</span>Page({\n<span>  </span><span style=\"color:#986801\">data</span><span>: {\n</span><span>    </span><span style=\"color:#986801\">devid</span><span>: </span><span style=\"color:#50a14f\">'0D9C82AD-1CC0-414D-9526-119E08D28124'</span><span>,\n</span><span>    </span><span style=\"color:#986801\">serid</span><span>: </span><span style=\"color:#50a14f\">'FEE7'</span><span>,\n</span><span>    </span><span style=\"color:#986801\">notifyId</span><span>: </span><span style=\"color:#50a14f\">'36F6'</span><span>,\n</span><span>    </span><span style=\"color:#986801\">writeId</span><span>: </span><span style=\"color:#50a14f\">'36F5'</span><span>,\n</span><span>    </span><span style=\"color:#986801\">charid</span><span>: </span><span style=\"color:#50a14f\">''</span><span>,\n</span><span>    </span><span style=\"color:#986801\">alldev</span><span>: [{ </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#50a14f\">''</span><span> }],\n</span>  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Obtain the Bluetooth state</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">openBluetoothAdapter</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.openBluetoothAdapter({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (!res.isSupportBLE) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Sorry, your mobile Bluetooth is unavailable temporarily'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Succeeded to initialize!'</span><span> });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">closeBluetoothAdapter</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.closeBluetoothAdapter({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function\">() =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Bluetooth closed!'</span><span> });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">getBluetoothAdapterState</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getBluetoothAdapterState({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (!res.available) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Sorry, your mobile Bluetooth is unavailable temporarily'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Scan the Bluetooth device</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">startBluetoothDevicesDiscovery</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.startBluetoothDevicesDiscovery({\n<span>      </span><span style=\"color:#986801\">allowDuplicatesKey</span><span>: </span><span style=\"color:#0184bb\">false</span><span>,\n</span><span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function\">() =&gt;</span><span> {\n</span>        my.onBluetoothDeviceFound({\n<span>          </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            </span><span style=\"color:#a0a1a7;font-style:italic\">// my.alert({content:'Listens to new device'+JSON.stringify(res)});</span><span>\n</span><span>            </span><span style=\"color:#a626a4\">var</span><span> deviceArray = res.devices;\n</span><span>            </span><span style=\"color:#a626a4\">for</span><span> (</span><span style=\"color:#a626a4\">var</span><span> i = deviceArray.length - </span><span style=\"color:#986801\">1</span><span>; i &gt;= </span><span style=\"color:#986801\">0</span><span>; i--) {\n</span><span>              </span><span style=\"color:#a626a4\">var</span><span> deviceObj = deviceArray[i];\n</span><span>              </span><span style=\"color:#a0a1a7;font-style:italic\">//Pair the target device with the device name or broadcast data, and then record the device ID for later use.</span><span>\n</span><span>              </span><span style=\"color:#a626a4\">if</span><span> (deviceObj.name == </span><span style=\"color:#c18401\">this</span><span>.data.name) {\n</span><span>                my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Target device is found'</span><span> });\n</span>                my.offBluetoothDeviceFound();\n<span>                </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>                  </span><span style=\"color:#986801\">deviceId</span><span>: deviceObj.deviceId,\n</span>                });\n<span>                </span><span style=\"color:#a626a4\">break</span><span>;\n</span>              }\n<!-- -->            }\n<!-- -->          },\n<span>          </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Failed to listen to new device'</span><span> + </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>          },\n<!-- -->        });\n<!-- -->      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Failed to start scanning'</span><span> + </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Stop scanning</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">stopBluetoothDevicesDiscovery</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.stopBluetoothDevicesDiscovery({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span>        my.offBluetoothDeviceFound();\n<span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Succeeded!'</span><span> });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Obtain the connected device</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">getConnectedBluetoothDevices</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getConnectedBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (res.devices.length === </span><span style=\"color:#986801\">0</span><span>) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'No connecting devices!'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span><span>        devid = res.devices[</span><span style=\"color:#986801\">0</span><span>].deviceId;\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Obtain all searched devices</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">getBluetoothDevices</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">bindKeyInput</span><span class=\"hljs-function\">(</span><span class=\"hljs-function hljs-params\">e</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>      </span><span style=\"color:#986801\">devid</span><span>: e.detail.value,\n</span>    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Connect the device</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">connectBLEDevice</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.connectBLEDevice({\n<span>      </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Succeeded to connect!'</span><span> });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Disconnect the device</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">disconnectBLEDevice</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.disconnectBLEDevice({\n<span>      </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function\">() =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Succeeded to disconnect!'</span><span> });\n</span>      },\n<span>      </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Obtain the services of the connected device</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">getBLEDeviceServices</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getConnectedBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (res.devices.length === </span><span style=\"color:#986801\">0</span><span>) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'No connected devices'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<!-- -->        my.getBLEDeviceServices({\n<span>          </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>          </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span><span>            </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>              </span><span style=\"color:#986801\">serid</span><span>: res.services[</span><span style=\"color:#986801\">0</span><span>].serviceId,\n</span>            });\n<!-- -->          },\n<span>          </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>          },\n<!-- -->        });\n<!-- -->      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Obtain the char ID of the connected device, read and write characteristics are respectively screened out.</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">getBLEDeviceCharacteristics</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getConnectedBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (res.devices.length === </span><span style=\"color:#986801\">0</span><span>) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'No connected devices'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>          </span><span style=\"color:#986801\">devid</span><span>: res.devices[</span><span style=\"color:#986801\">0</span><span>].deviceId,\n</span>        });\n<!-- -->        my.getBLEDeviceCharacteristics({\n<span>          </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>          </span><span style=\"color:#986801\">serviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.serid,\n</span><span>          </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span><span>            </span><span style=\"color:#a0a1a7;font-style:italic\">//See the related document for more information of the properties of the characteristics. Pair the characteristics according to the properties and record the value for later use.</span><span>\n</span><span>            </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>              </span><span style=\"color:#986801\">charid</span><span>: res.characteristics[</span><span style=\"color:#986801\">0</span><span>].characteristicId,\n</span>            });\n<!-- -->          },\n<span>          </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>          },\n<!-- -->        });\n<!-- -->      },\n<!-- -->    });\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Read and write data</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">readBLECharacteristicValue</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getConnectedBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (res.devices.length === </span><span style=\"color:#986801\">0</span><span>) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'No connected devices'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>          </span><span style=\"color:#986801\">devid</span><span>: res.devices[</span><span style=\"color:#986801\">0</span><span>].deviceId,\n</span>        });\n<!-- -->        my.readBLECharacteristicValue({\n<span>          </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>          </span><span style=\"color:#986801\">serviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.serid,\n</span><span>          </span><span style=\"color:#986801\">characteristicId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.notifyId,\n</span><span>          </span><span style=\"color:#a0a1a7;font-style:italic\">//1、Android reading service</span><span>\n</span><span>          </span><span style=\"color:#a0a1a7;font-style:italic\">// serviceId:'0000180d-0000-1000-8000-00805f9b34fb',</span><span>\n</span><span>          </span><span style=\"color:#a0a1a7;font-style:italic\">// characteristicId:'00002a38-0000-1000-8000-00805f9b34fb',</span><span>\n</span><span>          </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span>          },\n<span>          </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Failed to read'</span><span> + </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>          },\n<!-- -->        });\n<!-- -->      },\n<!-- -->    });\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">writeBLECharacteristicValue</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getConnectedBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (res.devices.length === </span><span style=\"color:#986801\">0</span><span>) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'No connected devices'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>          </span><span style=\"color:#986801\">devid</span><span>: res.devices[</span><span style=\"color:#986801\">0</span><span>].deviceId,\n</span>        });\n<!-- -->        my.writeBLECharacteristicValue({\n<span>          </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>          </span><span style=\"color:#986801\">serviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.serid,\n</span><span>          </span><span style=\"color:#986801\">characteristicId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.charid,\n</span><span>          </span><span style=\"color:#a0a1a7;font-style:italic\">//Android writing service</span><span>\n</span><span>          </span><span style=\"color:#a0a1a7;font-style:italic\">//serviceId:'0000180d-0000-1000-8000-00805f9b34fb',</span><span>\n</span><span>          </span><span style=\"color:#a0a1a7;font-style:italic\">//characteristicId:'00002a39-0000-1000-8000-00805f9b34fb',</span><span>\n</span><span>          </span><span style=\"color:#986801\">value</span><span>: </span><span style=\"color:#50a14f\">'ABCD'</span><span>,\n</span><span>          </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Succeeded to write data!'</span><span> });\n</span>          },\n<span>          </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>          },\n<!-- -->        });\n<!-- -->      },\n<!-- -->    });\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">notifyBLECharacteristicValueChange</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.getConnectedBluetoothDevices({\n<span>      </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>        </span><span style=\"color:#a626a4\">if</span><span> (res.devices.length === </span><span style=\"color:#986801\">0</span><span>) {\n</span><span>          my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'No connected devices'</span><span> });\n</span><span>          </span><span style=\"color:#a626a4\">return</span><span>;\n</span>        }\n<span>        </span><span style=\"color:#c18401\">this</span><span>.setData({\n</span><span>          </span><span style=\"color:#986801\">devid</span><span>: res.devices[</span><span style=\"color:#986801\">0</span><span>].deviceId,\n</span>        });\n<!-- -->        my.notifyBLECharacteristicValueChange({\n<span>          </span><span style=\"color:#986801\">state</span><span>: </span><span style=\"color:#0184bb\">true</span><span>,\n</span><span>          </span><span style=\"color:#986801\">deviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.devid,\n</span><span>          </span><span style=\"color:#986801\">serviceId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.serid,\n</span><span>          </span><span style=\"color:#986801\">characteristicId</span><span>: </span><span style=\"color:#c18401\">this</span><span>.data.notifyId,\n</span><span>          </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function\">() =&gt;</span><span> {\n</span><span>            </span><span style=\"color:#a0a1a7;font-style:italic\">//Listens to characteristic change events </span><span>\n</span>            my.onBLECharacteristicValueChange({\n<span>              </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>                </span><span style=\"color:#a0a1a7;font-style:italic\">//  my.alert({content: 'Changes of characteristics：'+JSON.stringify(res)});</span><span>\n</span><span>                my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Obtain the response data = '</span><span> + res.value });\n</span>              },\n<!-- -->            });\n<span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Succeeded to listen'</span><span> });\n</span>          },\n<span>          </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function hljs-params\">error</span><span class=\"hljs-function\"> =&gt;</span><span> {\n</span><span>            my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Failed to listen'</span><span> + </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span>          },\n<!-- -->        });\n<!-- -->      },\n<!-- -->    });\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">offBLECharacteristicValueChange</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span>    my.offBLECharacteristicValueChange();\n<!-- -->  },\n<!-- -->\n<span>  </span><span style=\"color:#a0a1a7;font-style:italic\">//Other events</span><span>\n</span><span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">bluetoothAdapterStateChange</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    my.onBluetoothAdapterStateChange(</span><span style=\"color:#c18401\">this</span><span>.getBind(</span><span style=\"color:#50a14f\">'onBluetoothAdapterStateChange'</span><span>));\n</span>  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">onBluetoothAdapterStateChange</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    </span><span style=\"color:#a626a4\">if</span><span> (res.error) {\n</span><span>      my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span><span>    } </span><span style=\"color:#a626a4\">else</span><span> {\n</span><span>      my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Changes of the Bluetooth state：'</span><span> + </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span>    }\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">offBluetoothAdapterStateChange</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    my.offBluetoothAdapterStateChange(</span><span style=\"color:#c18401\">this</span><span>.getBind(</span><span style=\"color:#50a14f\">'onBluetoothAdapterStateChange'</span><span>));\n</span>  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">getBind</span><span class=\"hljs-function\">(</span><span class=\"hljs-function hljs-params\">name</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    </span><span style=\"color:#a626a4\">if</span><span> (!</span><span style=\"color:#c18401\">this</span><span>[</span><span style=\"color:#50a14f\">`bind</span><span style=\"color:#e45649\">${name}</span><span style=\"color:#50a14f\">`</span><span>]) {\n</span><span>      </span><span style=\"color:#c18401\">this</span><span>[</span><span style=\"color:#50a14f\">`bind</span><span style=\"color:#e45649\">${name}</span><span style=\"color:#50a14f\">`</span><span>] = </span><span style=\"color:#c18401\">this</span><span>[name].bind(</span><span style=\"color:#c18401\">this</span><span>);\n</span>    }\n<span>    </span><span style=\"color:#a626a4\">return</span><span> </span><span style=\"color:#c18401\">this</span><span>[</span><span style=\"color:#50a14f\">`bind</span><span style=\"color:#e45649\">${name}</span><span style=\"color:#50a14f\">`</span><span>];\n</span>  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">BLEConnectionStateChanged</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    my.onBLEConnectionStateChanged(</span><span style=\"color:#c18401\">this</span><span>.getBind(</span><span style=\"color:#50a14f\">'onBLEConnectionStateChanged'</span><span>));\n</span>  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">onBLEConnectionStateChanged</span><span class=\"hljs-function\">(</span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    </span><span style=\"color:#a626a4\">if</span><span> (res.error) {\n</span><span>      my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(error) });\n</span><span>    } </span><span style=\"color:#a626a4\">else</span><span> {\n</span><span>      my.alert({ </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#50a14f\">'Changes of connection state：'</span><span> + </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res) });\n</span>    }\n<!-- -->  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">offBLEConnectionStateChanged</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    my.offBLEConnectionStateChanged(</span><span style=\"color:#c18401\">this</span><span>.getBind(</span><span style=\"color:#50a14f\">'onBLEConnectionStateChanged'</span><span>));\n</span>  },\n<span>  </span><span class=\"hljs-function\" style=\"color:#4078f2\">onUnload</span><span class=\"hljs-function\">(</span><span class=\"hljs-function\">)</span><span> {\n</span><span>    </span><span style=\"color:#c18401\">this</span><span>.offBLEConnectionStateChanged();\n</span><span>    </span><span style=\"color:#c18401\">this</span><span>.offBLECharacteristicValueChange();\n</span><span>    </span><span style=\"color:#c18401\">this</span><span>.offBluetoothAdapterStateChange();\n</span><span>    </span><span style=\"color:#c18401\">this</span><span>.closeBluetoothAdapter();\n</span>  },\n<!-- -->});</code></pre></div><a name=\"Whether-to-pass-callback-value-or-not\"></a><h2 id=\"a4bc819d\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"a4bc819d\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span>Whether to pass callback value or not</h2><ul><li>If the callback value is not passed, the callbacks of all events will be removed. The sample code is as follows:</li></ul><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code style=\"white-space:pre\"><span>my.offBLEConnectionStateChanged()</span><span style=\"color:#a0a1a7;font-style:italic\">;</span></code></pre></div><ul><li>If the callback value is passed, only the corresponding callback is removed. The sample code is as follows:</li></ul><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code style=\"white-space:pre\"><span>my.off</span><span class=\"hljs-constructor\">BLEConnectionStateChanged(</span><span class=\"hljs-constructor hljs-params\">this</span><span class=\"hljs-constructor\">.</span><span class=\"hljs-constructor hljs-params\">callback</span><span class=\"hljs-constructor\">)</span><span>;</span></code></pre></div></div></div><div class=\"pswp\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"pswp__bg\"></div><div class=\"pswp__scroll-wrap\"><div class=\"pswp__container\"><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div></div><div class=\"pswp__ui pswp__ui--hidden\"><div class=\"pswp__top-bar\"><div class=\"pswp__counter\"></div><button class=\"pswp__button pswp__button--close\" title=\"Close (Esc)\"></button><button class=\"pswp__button pswp__button--share\" title=\"Share\"></button><button class=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\"></button><button class=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\"></button><div class=\"pswp__preloader\"><div class=\"pswp__preloader__icn\"><div class=\"pswp__preloader__cut\"><div class=\"pswp__preloader__donut\"></div></div></div></div></div><div class=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\"><div class=\"pswp__share-tooltip\"></div></div><button class=\"pswp__button pswp__button--arrow--left\" title=\"Previous (arrow left)\"></button><button class=\"pswp__button pswp__button--arrow--right\" title=\"Next (arrow right)\"></button><div class=\"pswp__caption\"><div class=\"pswp__caption__center\"></div></div></div></div></div></div></article></main></div></div></div></div></div>\n    \n    \n  \n  <iframe src=\"https://tracert.alipay.com/cross.html\" style=\"width: 1px; height: 1px; position: absolute; left: -100px; bottom: -100px; display: none;\"></iframe></body></html>",
  "warning": "This scrape job was throttled at your current concurrency limit. If you'd like to scrape faster, you can upgrade your plan."
}