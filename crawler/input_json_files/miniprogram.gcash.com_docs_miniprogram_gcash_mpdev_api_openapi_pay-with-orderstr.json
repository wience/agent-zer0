{
  "markdown": "# Use OrderStr to pay\n\n2022-07-03 18:44\n\nUsers can use the wallet app to pay for the order placed in the mini program if the wallet app provides the payment service. This document introduces the payment by calling the [my.tradePay](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay) API with `orderStr`. The following two payment types are supported:\n\n- [General online payment](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_pay-with-orderstr#gUNsA)\n- [Pre-authorization payment](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_pay-with-orderstr#revlp)\n\n# General online payment\n\nUsers can complete a general online payment in the mini program.\n\n## User experience\n\nTo complete a payment in the mini program, users usually follow the steps below:\n\n1. The user chooses goods in the mini program and creates an order, then presses the **Pay** button in the mini program.\n2. The mini program redirects the user to the wallet app and the wallet app displays the payment page.\n3. The user confirms the order information, such as the payee and amount, then clicks the **Pay** button to make the payment.\n4. After confirming the payment, the wallet app displays the payment result and redirects the user back to the payment result page in the mini program.\n\n## Procedures\n\nTo use the `my.tradePay` API to initiate a payment in the mini program, mini program developers must complete the following steps:\n\n1. Confirm that the payment service provided by the wallet app supports the payment by `orderStr` and obtain the integration guide from the wallet app.\n2. Integrate the payment service at the mini program server side.\n3. Create a mini program in the wallet workspace on the Mini Program Platform, or make sure that the mini program can be published in the wallet app.\n4. Provide goods and payment services in the mini program.\n5. Publish the mini program.\n\n## Payment process\n\nThe following figure illustrates the payment process:\n\n![image](https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*s18rS63vzdoAAAAAAAAAAABkARQnAQ)\n\nFigure 1. Process flow of the general payment\n\nThe payment process contains the following steps:\n\n1. The user places an order in the mini program (Step 1).\n2. The mini program client sends a request to create the order to the mini program server by calling the [my.request](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_network_request) API (Step 1.1).\n3. The mini program server creates the order and returns `orderStr` to the mini program client (Step 1.1.1 & 1.1.2).\n4. The mini program client initiates the payment request by calling the [my.tradePay](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay) API with `orderStr` to the wallet app (Step 1.1.2.1).\n5. The wallet processes the payment request internally and the wallet app renders the cashier page (Step 1.1.2.1.1 - 1.1.2.1.3).\n6. The user confirms the payment and the wallet app displays the payment result (Step 2 - 2.2).\n7. The wallet app returns the payment result to the mini program client. At the same time, the wallet server returns the payment result to the mini program server (Step 2.3).\n8. The mini program client displays the payment result (Step 2.3.1).\n\n**Note:**\n\nThe payment flow is for reference and may vary depending on the API implementation of the wallet.\n\n# Pre-authorization payment\n\nPre-authorization payment is a common practice in rental and hotel industries where the user can pre-authorize a payment in advance. Unlike goods with confirmed prices, the price of some services can only be determined when the user has finished using the service. As such, service merchants can use pre-authorization payments to ensure that the order can be paid before providing the service.\n\nMerchants can call the [my.tradePay](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay) API with `orderStr` to initiate a pre-authorization payment request via the mini program. After the user has granted pre-authorization, the funds are captured by the merchant automatically after the service amount is settled.\n\n## User experience\n\nTo complete a pre-authorization payment, users usually follow the steps below:\n\n1. The user confirms to use the service provided by the mini program.\n2. The mini program redirects the user to the pre-authorization page in the wallet app.\n3. The user confirms the authorization, then the wallet app redirects the user back to the mini program. The user starts to use the service.\n4. After the user has finished using the service and the service fee is confirmed, the funds are deducted by the merchant automatically and the user receives a notification in the wallet app.\n\n## Procedures\n\nTo use the `my.tradePay` API to complete the pre-authorization in the mini program, mini program developers must complete the following steps:\n\n1. Confirm that the wallet app supports the pre-authorization capability and obtain the integration guide from the wallet.\n2. Integrate the payment service at the mini program server side.\n3. Create a mini program in the wallet workspace on the Mini Program Platform, or make sure that the mini program can be published in the wallet app.\n4. Provide the service that requires pre-authorization in the mini program.\n5. Publish the mini program.\n\n## Payment process\n\nThe following figure illustrates the pre-authorization payment process:\n\n![image](https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*E7NLRKJBBYsAAAAAAAAAAABkARQnAQ)\n\nFigure 2. Process flow of the pre-authorization payment\n\nThe payment process contains the following steps:\n\n1. The user starts to use the service in the mini program (Step 1).\n2. The mini program client sends a request to create the order to the mini program server by calling the [my.request](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_network_request) API (Step 2).\n3. The mini program server creates the order and returns `orderStr` to the mini program client (Step 3 & 4).\n4. The mini program client initiates the pre-authorization request by calling the [my.tradePay](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay) API with `orderStr` to the wallet app (Step 1.1.2.1).\n5. The wallet processes the pre-authorization request internally and the wallet app renders the pre-authorization page (Step 6 - 8).\n6. The user completes the pre-authorization and the wallet app returns the pre-authorization result to the mini program client (Step 10 - 12).\n7. The user starts to use the service provided by the mini program. When the user has finished using the service, the mini program client sends the payment request to the mini program server by calling the [my.request](https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_network_request) API (Step 13 - 15).\n8. The mini program server sends the payment request by calling the server API provided by the wallet and the wallet server returns the payment result (Step 16 & 17).\n\n**Note:**\n\nThe payment flow is for reference and may vary depending on the API implementation of the wallet.\n\n## Sample code\n\nSample code for the `my.tradePay` API calling is as follows:\n\ncopy\n\n```javascript\nmy.tradePay({\n    orderStr: 'app_id=2018112803019836&biz_content=%7B%22amount%22%3A%220.02%22%2C%22extra_param%22%3A%22%7B%5C%22category%5C%22%3A%5C%22CHARGE_PILE_CAR%5C%22%7D%22%2C%22order_title%22%3A%22%D6%A7%B8%B6%B1%A6%D4%A4%CA%DA%C8%A8%22%2C%22out_order_no%22%3A%22ZMOutOrderNoAppFreeze2018052915543415090975%22%2C%22out_request_no%22%3A%22ZMOutReqNoAppFreeze20180529155434581875858%22%2C%22pay_timeout%22%3A%222d%22%2C%22payee_user_id%22%3A%222088202224929664%22%2C%22product_code%22%3A%22PRE_AUTH_ONLINE%22%7D&charset=GBK&format=json&sign=L4wk%2FNKcbJOo3n6Q5qbPzn0jUsvZlK4jr7iXnghudR0zeWJMmeNC71qIBSQfIz45n%2B5iTd0NQ5IK581xI2xCShTCiKAywnQcDmA%2Bjf%2BrRdKCDQCMLfCz%2BZ37C%2B6zxAX3e81%2F8Hr29lw4VPFfHkp9FmMwKw%2FGkNfV5ZlWoh7UtN8%3D&sign_type=RSA&timestamp=2018-05-29+15%3A54%3A35&version=1.0',\n    success: function(res) {\n        my.alert({\n            content: JSON.stringify(res),\n        });\n    },\n    fail: function(res) {\n        my.alert({\n            content: JSON.stringify(res),\n        });\n    },\n});\n```\n\n[iframe](https://tracert.alipay.com/cross.html)",
  "metadata": {
    "ogImage": "https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*s18rS63vzdoAAAAAAAAAAABkARQnAQ",
    "keywords": "",
    "og:title": "Use OrderStr to pay | Developer's Guide | Documentation",
    "favicon": "https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*rOH-T5TEL-cAAAAAAAAAAABkARQnAQ",
    "og:url": "",
    "og:image": "https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*s18rS63vzdoAAAAAAAAAAABkARQnAQ",
    "og:description": "Users can use the wallet app to pay for the order placed in the mini program if the wallet app provides the payment service. This document introduces the payment by calling the my.",
    "ogDescription": "Users can use the wallet app to pay for the order placed in the mini program if the wallet app provides the payment service. This document introduces the payment by calling the my.",
    "ogUrl": "",
    "ogTitle": "Use OrderStr to pay | Developer's Guide | Documentation",
    "title": "Use OrderStr to pay | Developer's Guide | Documentation",
    "description": "Users can use the wallet app to pay for the order placed in the mini program if the wallet app provides the payment service. This document introduces the payment by calling the my.",
    "robots": "noarchive",
    "viewport": "width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover",
    "og:type": "website",
    "scrapeId": "12031840-9bed-4cc9-93bb-5a2d41abaa54",
    "sourceURL": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_pay-with-orderstr",
    "url": "https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_pay-with-orderstr",
    "statusCode": 200
  },
  "html": "<!DOCTYPE html><html style=\"--vh: 1000px;\" data-theme=\"light\">\n    <body>\n    \n    \n    <div id=\"root\"><div class=\"index-module_height100__dDLuI\"><div style=\"top:0\"></div><div class=\"styles-module_searchWrap__mIEtV index-module_mobileSearch__Lianv \"><svg class=\"icon icon-search styles-module_searchIcon__2wekS\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z\"></path></svg><input type=\"text\" title=\"Press 's' to start the search\" placeholder=\"Search documentation\"><div class=\"styles-module_resultWrap__LQyY1 \"><div class=\"styles-module_result__6EDKs\"><div class=\"styles-module_resultScroll__x5srB\"></div></div><div class=\"styles-module_mask__naKUh\"></div></div></div><div class=\"undefined index-module_height100__dDLuI\"><div class=\"index-module_container__-pyWH    idocs-global-container  idocs-global-normal-container\"><div class=\"index-module_center__Kh8xX  idocs-global-index-center \" style=\"max-width: none; min-height: calc(var(--vh, 1vh) * 100 - 26px);\"><main class=\"index-module_main__2B9Eq    idocs-global-main-with-toc\" style=\"padding-left:264px;width:0\"><article class=\"index-module_content__6p5ch  idocs-global-content\"><div class=\"index-module_contentInner__KQHGJ idocs-global-content-inner\"><div class=\"styles-module_docBody__zUo8V\"><h1 class=\"styles-module_title__6bcTh styles-module_anchored__AxVRP \"><span class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span><span>Use OrderStr to pay</span></span></h1><div class=\"styles-module_updateDate__1rqmL\"><time datetime=\"2022-07-03 18:44\" style=\"color: var(--font-color-third);\"><svg class=\"icon icon-clock\" width=\"1em\" height=\"1em\"><path d=\"M6.832 0C3.058 0 0 3.134 0 7s3.058 7 6.832 7 6.833-3.134 6.833-7-3.059-7-6.833-7zm4.152 11.253a5.835 5.835 0 01-1.867 1.29 5.695 5.695 0 01-2.285.473 5.717 5.717 0 01-2.284-.472 5.872 5.872 0 01-1.867-1.29 5.995 5.995 0 01-1.259-1.912A6.096 6.096 0 01.961 7c0-.812.155-1.6.46-2.34A6.032 6.032 0 012.68 2.746a5.835 5.835 0 011.866-1.29A5.706 5.706 0 016.832.984c.793 0 1.562.159 2.285.472.699.304 1.326.737 1.867 1.29.539.552.963 1.196 1.258 1.912.307.742.462 1.53.462 2.342s-.155 1.6-.46 2.34a5.998 5.998 0 01-1.26 1.913zM9.78 6.891H7.313V3.609a.486.486 0 00-.48-.492c-.266 0-.481.22-.481.492v3.282c0 .544.43.984.96.984h2.47c.265 0 .48-.22.48-.492a.486.486 0 00-.48-.492z\" fill=\"currentColor\" fill-rule=\"nonzero\" fill-opacity=\".7\"></path></svg>2022-07-03 18:44</time></div><div class=\"styles-module_content__2jcQS styles-module_yuqueContent__iJuXe\"><div class=\"lake-content-editor-core lake-engine lake-typography-traditional\" data-lake-element=\"root\" data-selection-undefined=\"%7B%22path%22%3A%5B%5B18%2C3%2C4%2C0%2C34%5D%2C%5B18%2C3%2C4%2C0%2C34%5D%5D%2C%22active%22%3Atrue%7D\"><p data-lake-id=\"2b67e42f65ef4afb1c22708dd6610d2a\" id=\"bdd9bfd988fc603ddb79723e0db84377\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Users can use the wallet app to pay for the order placed in the mini program if the wallet app provides the payment service. This document introduces the payment by calling the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay\"><span>my.tradePay</span></a><em> </em><span>API with </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span>. The following two payment types are supported:</span></p><ul data-lake-id=\"9dcbf3a789e0812b2788eafac2ece904\" lake-indent=\"0\" style=\"list-style-type:disc;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"d8244c3e0d963cf53d9e82554fd5a93a\"><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_pay-with-orderstr#gUNsA\"><span>General online payment</span></a></li><li data-lake-id=\"1c87d0f70c42665e82f37e20be5acc38\"><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_pay-with-orderstr#revlp\"><span>Pre-authorization payment</span></a></li></ul><h1 data-lake-id=\"e61af9957dc546b333988428e1cb9fd4\" id=\"gUNsA\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:28px;line-height:36px\" class=\"styles-module_anchored__AxVRP h1 \"><span data-id=\"gUNsA\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>General online payment</span></h1><p data-lake-id=\"02b43f422e770aa0a3abd4b945fba17f\" id=\"9a23bacb0264e43cfbb4ea41e0086174\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Users can complete a general online payment in the mini program.</span></p><h2 data-lake-id=\"9a5aa3550fd1a36d6f481dc54cab22e0\" id=\"vhIze\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"vhIze\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>User experience</span></h2><p data-lake-id=\"69da63279c4844203d421f67d9c166f3\" id=\"bc48faf38c368a95544b49697310290f\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>To complete a payment in the mini program, users usually follow the steps below:</span></p><ol data-lake-id=\"bcaaf555cd3e01efc03bed1d77c5b211\" lake-indent=\"0\" style=\"list-style-type:decimal;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"dfdbf62e2c9aabd5af0123c4f2ddb986\"><span>The user chooses goods in the mini program and creates an order, then presses the </span><strong><span>Pay</span></strong><span> button in the mini program.</span></li><li data-lake-id=\"f8cbb57c7b285faa92ac5641478bde11\"><span>The mini program redirects the user to the wallet app and the wallet app displays the payment page.</span></li><li data-lake-id=\"64f4f75af95e34afc279d527c078defb\"><span>The user confirms the order information, such as the payee and amount, then clicks the </span><strong><span>Pay</span></strong><span> button to make the payment.</span></li><li data-lake-id=\"e3e3ed4aaddaa009756683b0a0f72fa5\"><span>After confirming the payment, the wallet app displays the payment result and redirects the user back to the payment result page in the mini program. </span></li></ol><h2 data-lake-id=\"8dcbb84c4f75b5971300bc6e49a069bc\" id=\"Guides\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"Guides\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>Procedures</span></h2><p data-lake-id=\"75276b1aab8360af884043823dbaf885\" id=\"0c4d068e4aede2bc9d552ce387999b01_p_4\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>To use the </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>my.tradePay</span></code><span> API to initiate a payment in the mini program, mini program developers must complete the following steps:</span></p><ol data-lake-id=\"1b9c0779456fa54af6eaca50fc03fcfd\" lake-indent=\"0\" style=\"list-style-type:decimal;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"e44d7fc6a69441138267d0293c75c527\"><span>Confirm that the payment service provided by the wallet app supports the payment by </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span> and obtain the integration guide from the wallet app. </span></li><li data-lake-id=\"a01e0b3068da6787029f5c20e1b7ed25\"><span>Integrate the payment service at the mini program server side.</span></li><li data-lake-id=\"dbd4edec8ed029ab209253b95f76d956\"><span>Create a mini program in the wallet workspace on the Mini Program Platform, or make sure that the mini program can be published in the wallet app.</span></li><li data-lake-id=\"c948b714cbb60b62e96c6db7d89e0804\"><span>Provide goods and payment services in the mini program.</span></li><li data-lake-id=\"662946ad9f3b96b48709e9e15b5b4b1a\"><span>Publish the mini program.</span></li></ol><h2 data-lake-id=\"10eeecbd2cc3cbad5ff8b765ee336a47\" id=\"A83c3\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"A83c3\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>Payment process</span></h2><p data-lake-id=\"9389dff1de823eca961a3c4019d816f8\" id=\"4361a715a873e2c782f3744cce965058_p_6\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>The following figure illustrates the payment process: </span></p><p data-lake-id=\"37997c415f48c48894d915ec4abc665f\" id=\"df987c419e955fea88efcd2a604e0248_p_8\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span data-card-type=\"inline\" data-lake-card=\"image\" id=\"gRk67\" style=\"display:block\"><img alt=\"image\" data-role=\"image\" src=\"https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*s18rS63vzdoAAAAAAAAAAABkARQnAQ\" data-raw-src=\"\" title=\"image\" data-height=\"2250px\" style=\"visibility:visible;width:2463px\" class=\"docs-image loaded showImg\" data-src=\"https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*s18rS63vzdoAAAAAAAAAAABkARQnAQ\" loading=\"lazy\"></span></p><p data-lake-id=\"357b3f25d76c236bf9d4846cae1fe727\" id=\"eadc4ec477465f1f239730d987d394b1_p_9\" style=\"text-align:center;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Figure 1. Process flow of the general payment</span></p><p data-lake-id=\"7fddae1bcc69e603e4fcf3d1f82cefc4\" id=\"6fedfd7d77f9e929013bde3ec5c2b89a\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>The payment process contains the following steps:</span></p><ol data-lake-id=\"61265646b1cac0c37291ae2b27d5996d\" lake-indent=\"0\" style=\"list-style-type:decimal;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"71ed362fe2bf4e1f154cf97401cee1b3\"><span>The user places an order in the mini program (Step 1). </span></li><li data-lake-id=\"649059e1996a3bd69599486a1024935a\"><span>The mini program client sends a request to create the order to the mini program server by calling the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_network_request\"><span>my.request</span></a><span> API (Step 1.1). </span></li><li data-lake-id=\"c8f88c064a67dfe11ab54eae7b80e716\"><span>The mini program server creates the order and returns </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span> to the mini program client (Step 1.1.1 &amp; 1.1.2). </span></li><li data-lake-id=\"024c57e1aa32cb072db20f8b9f97199e\"><span>The mini program client initiates the payment request by calling the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay\"><span>my.tradePay</span></a><span> API with </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span> to the wallet app (Step 1.1.2.1).</span></li><li data-lake-id=\"7351a9921d7a43185e5480cafbbd07fe\"><span>The wallet processes the payment request internally and the wallet app renders the cashier page (Step 1.1.2.1.1 - 1.1.2.1.3). </span></li><li data-lake-id=\"32d9caa0a09e95812c3531404fe52ac6\"><span>The user confirms the payment and the wallet app displays the payment result (Step 2 - 2.2). </span></li><li data-lake-id=\"f37957ae4d622a6db7f0848edede82d4\"><span>The wallet app returns the payment result to the mini program client. At the same time, the wallet server returns the payment result to the mini program server (Step 2.3). </span></li><li data-lake-id=\"74dad032ebbbfff810bcae06b44dd635\"><span>The mini program client displays the payment result (Step 2.3.1). </span></li></ol><p data-lake-id=\"daa9da73ef498b5ccc7cd2ced94ec3be\" id=\"aa0091184041e5a8e64242e871371a1f\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><strong><span>Note:</span></strong></p><p data-lake-id=\"413eec29b1602946246cc6faf9bf0c43\" id=\"7efc9b4538b081f62c66909704ac7df6\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>The payment flow is for reference and may vary depending on the API implementation of the wallet.</span></p><h1 data-lake-id=\"cf17b165209dcdb01d657f5f5444d280\" id=\"revlp\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:28px;line-height:36px\" class=\"styles-module_anchored__AxVRP h1 \"><span data-id=\"revlp\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>Pre-authorization payment</span></h1><p data-lake-id=\"17df5994faa13d96e11d72746851d06d\" id=\"b7d7e6cec8ff14ed1f37151b8d46c8ad\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Pre-authorization payment is a common practice in rental and hotel industries where the user can pre-authorize a payment in advance. Unlike goods with confirmed prices, the price of some services can only be determined when the user has finished using the service. As such, service merchants can use pre-authorization payments to ensure that the order can be paid before providing the service.</span></p><p data-lake-id=\"8202c1a240de770a904f98dd287de620\" id=\"7d55894c7518ca8b997a29f89c566684\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\">&nbsp;</p><p data-lake-id=\"2ad35cc88e41db1954d220ff40bf1370\" id=\"61b4ee3c657b924ec5587cee66c40bd4\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Merchants can call the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay\"><span>my.tradePay</span></a><span> API with </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span> to initiate a pre-authorization payment request via the mini program. After the user has granted pre-authorization, the funds are captured by the merchant automatically after the service amount is settled.</span></p><h2 data-lake-id=\"80d57c8b3817375709fe0e0206d50785\" id=\"PD6S4\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"PD6S4\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>User experience</span></h2><p data-lake-id=\"c14fe4308ca0d118f1a9325ce939e0af\" id=\"4c8ca276a03c611b12b34a9ec8512143_p_19\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>To complete a pre-authorization payment, users usually follow the steps below:</span></p><ol data-lake-id=\"146cf3be5c62bfe19ee2abdc08539749\" lake-indent=\"0\" style=\"list-style-type:decimal;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"b788bd5539ee994deb94a0cf15e22765\"><span>The user confirms to use the service provided by the mini program.</span></li><li data-lake-id=\"5ab601eeacf1af4c8ac78dbf944485ea\"><span>The mini program redirects the user to the pre-authorization page in the wallet app. </span></li><li data-lake-id=\"6662007fa1a80d92adcb4847f55de9ce\"><span>The user confirms the authorization, then the wallet app redirects the user back to the mini program. The user starts to use the service.</span></li><li data-lake-id=\"b462faeb796f9009e794445fdfbec36b\"><span>After the user has finished using the service and the service fee is confirmed, the funds are deducted by the merchant automatically and the user receives a notification in the wallet app.</span></li></ol><h2 data-lake-id=\"54c793820cbc6152ac661a28d398ad0a\" id=\"fjmMf\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"fjmMf\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>Procedures</span></h2><p data-lake-id=\"86439df711156e8d0a59c7b38a7af581\" id=\"59a77499105e33f187d5a8c289f50472\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>To use the </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>my.tradePay</span></code><span> API to complete the pre-authorization in the mini program, mini program developers must complete the following steps:</span></p><ol data-lake-id=\"38599a5922538ec48290b67d1ef935cd\" lake-indent=\"0\" style=\"list-style-type:decimal;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"af36af81081e336dde7daf3106ecb824\"><span>Confirm that the wallet app supports the pre-authorization capability and obtain the integration guide from the wallet. </span></li><li data-lake-id=\"0bbff090119f59bf41c0ac8e1f3914f5\"><span>Integrate the payment service at the mini program server side.</span></li><li data-lake-id=\"b874820ad58f155d093eb6cf7347d4a0\"><span>Create a mini program in the wallet workspace on the Mini Program Platform, or make sure that the mini program can be published in the wallet app.</span></li><li data-lake-id=\"04f5627f676efb31ccb68ece2eebda3b\"><span>Provide the service that requires pre-authorization in the mini program.</span></li><li data-lake-id=\"78549af601a2030c6a4cd9b0888ce907\"><span>Publish the mini program.</span></li></ol><h2 data-lake-id=\"9389315021691de1d75d12fb3fc4b9a4\" id=\"htKyw\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"htKyw\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>Payment process</span></h2><p data-lake-id=\"82aff6423acd315efa8f91207add8215\" id=\"83d13a1eba21d3ceb47d3f415a86f3bd_p_24\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>The following figure illustrates the pre-authorization payment process:</span></p><p data-lake-id=\"8e3b5b21d6ff14d6f2a320a46090e116\" id=\"2597ab488680d9554e4c19cbf39d5ba2_p_26\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span data-card-type=\"inline\" data-lake-card=\"image\" id=\"e4Dhc\" style=\"display:block\"><img alt=\"image\" data-role=\"image\" src=\"https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*E7NLRKJBBYsAAAAAAAAAAABkARQnAQ\" data-raw-src=\"\" title=\"image\" data-height=\"2421px\" style=\"visibility:visible;width:2463px\" class=\"docs-image loaded showImg\" data-src=\"https://gw.alipayobjects.com/mdn/rms_150082/afts/img/A*E7NLRKJBBYsAAAAAAAAAAABkARQnAQ\" loading=\"lazy\"></span></p><p data-lake-id=\"3a0e27b361db7d19f56010919dae3f9c\" id=\"7622b812d24904909bdc615cef66bae9\" style=\"text-align:center;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Figure 2. Process flow of the pre-authorization payment</span></p><p data-lake-id=\"f21e442aca17e038b725a1a59fa0c5dc\" id=\"23aa8d84be2e361c1ec071811390427a\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>The payment process contains the following steps:</span></p><ol data-lake-id=\"48e40ce6783cc19d8d67c5ef84e475ee\" lake-indent=\"0\" style=\"list-style-type:decimal;margin:0px;padding-left:23px;font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word\"><li data-lake-id=\"534bd188ef5d4242eab5cbc20ceac3d2\"><span>The user starts to use the service in the mini program (Step 1). </span></li><li data-lake-id=\"a303028d0142ffa87693c4f10779ec68\"><span>The mini program client sends a request to create the order to the mini program server by calling the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_network_request\"><span>my.request</span></a><span> API (Step 2). </span></li><li data-lake-id=\"9430866992c174f8496751ebc695192d\"><span>The mini program server creates the order and returns </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span> to the mini program client (Step 3 &amp; 4). </span></li><li data-lake-id=\"3da403779dc18175bd8fddffeec91512\"><span>The mini program client initiates the pre-authorization request by calling the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_openapi_tradepay\"><span>my.tradePay</span></a><span> API with </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>orderStr</span></code><span> to the wallet app (Step 1.1.2.1).   </span></li><li data-lake-id=\"b52e7c81a5de6be47e772e61def5ad41\"><span>The wallet processes the pre-authorization request internally and the wallet app renders the pre-authorization page (Step 6 - 8). </span></li><li data-lake-id=\"db2715365c3f3d28f212fed37690951a\"><span>The user completes the pre-authorization and the wallet app returns the pre-authorization result to the mini program client (Step 10 - 12). </span></li><li data-lake-id=\"63616cbc8db42512f54cdcc8745c0fe4\"><span>The user starts to use the service provided by the mini program. When the user has finished using the service, the mini program client sends the payment request to the mini program server by calling the </span><a href=\"https://miniprogram.gcash.com/docs/miniprogram_gcash/mpdev/api_network_request\"><span>my.request</span></a><span> API (Step 13 - 15). </span></li><li data-lake-id=\"8be0d94a96cbbc30e68d90eb3f3a5efc\"><span>The mini program server sends the payment request by calling the server API provided by the wallet and the wallet server returns the payment result (Step 16 &amp; 17). </span></li></ol><p data-lake-id=\"505c6b3af54ea1f6a06f2ebbef02dbe8\" id=\"d47df1442fb03d599a8e303905390ab9\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><strong><span>Note:</span></strong></p><p data-lake-id=\"34a391d0aac0b5cf878f54a5e6a7625a\" id=\"adac7b411b7e9eeee3019dbfff58e055\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>The payment flow is for reference and may vary depending on the API implementation of the wallet.</span></p><h2 data-lake-id=\"1f6ed69874c0a77e54c7088847de2392\" id=\"SHeuM\" style=\"padding:7px 0px;margin:0px;font-weight:700;font-size:24px;line-height:32px\" class=\"styles-module_anchored__AxVRP h2 \"><span data-id=\"SHeuM\" class=\"index-module_anchor__UrjO7 styles-module_anchorLink__mbBm1\"><span role=\"img\" aria-label=\"link\" class=\"anticon anticon-link\"><svg viewBox=\"64 64 896 896\" focusable=\"false\" data-icon=\"link\" width=\"1em\" height=\"1em\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z\"></path></svg></span></span><span>Sample code</span></h2><p data-lake-id=\"ae9c62087a9b364e533fc256677da072\" id=\"cad7b530726476ccf88175c38dafa215\" style=\"font-size:14px;color:rgb(38, 38, 38);line-height:1.74;letter-spacing:0.05em;outline-style:none;overflow-wrap:break-word;margin:0px\"><span>Sample code for the </span><code style=\"font-family:monospace;font-size:inherit;background-color:rgba(0, 0, 0, 0.06);padding:0px 2px;border:1px solid rgba(0, 0, 0, 0.08);border-radius:2px;line-height:inherit;overflow-wrap:break-word;text-indent:0px\"><span>my.tradePay</span></code><span> API calling is as follows:</span></p><div data-card-type=\"block\" data-lake-card=\"codeblock\" id=\"87b0d93d\" data-language=\"javascript\"><div class=\"lake-codeblock-content\" style=\"border:1px solid rgb(232, 232, 232);max-width:750px;color:rgba(0, 0, 0, 0.65);margin:0px;padding:0px;background:rgb(249, 249, 249)\"><div class=\"CodeMirror-sizer\" style=\"color:rgba(0, 0, 0, 0.65);margin:0px;padding:0px;background:none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0)\"><div class=\"styles-module_copyWrapper__Fc5qV\"><div class=\"styles-module_copyButton__vn-Pc\"><svg class=\"icon icon-copy\" viewBox=\"64 64 896 896\" width=\"1em\" height=\"1em\" fill=\"#ccc\" aria-hidden=\"true\"><path d=\"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z\"></path></svg>copy</div><pre style=\"display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa;transition:background var(--transition-delay)\"><code class=\"language-javascript\" style=\"white-space:pre\"><span>my.tradePay({\n</span><span>    </span><span style=\"color:#986801\">orderStr</span><span>: </span><span style=\"color:#50a14f\">'app_id=2018112803019836&amp;biz_content=%7B%22amount%22%3A%220.02%22%2C%22extra_param%22%3A%22%7B%5C%22category%5C%22%3A%5C%22CHARGE_PILE_CAR%5C%22%7D%22%2C%22order_title%22%3A%22%D6%A7%B8%B6%B1%A6%D4%A4%CA%DA%C8%A8%22%2C%22out_order_no%22%3A%22ZMOutOrderNoAppFreeze2018052915543415090975%22%2C%22out_request_no%22%3A%22ZMOutReqNoAppFreeze20180529155434581875858%22%2C%22pay_timeout%22%3A%222d%22%2C%22payee_user_id%22%3A%222088202224929664%22%2C%22product_code%22%3A%22PRE_AUTH_ONLINE%22%7D&amp;charset=GBK&amp;format=json&amp;sign=L4wk%2FNKcbJOo3n6Q5qbPzn0jUsvZlK4jr7iXnghudR0zeWJMmeNC71qIBSQfIz45n%2B5iTd0NQ5IK581xI2xCShTCiKAywnQcDmA%2Bjf%2BrRdKCDQCMLfCz%2BZ37C%2B6zxAX3e81%2F8Hr29lw4VPFfHkp9FmMwKw%2FGkNfV5ZlWoh7UtN8%3D&amp;sign_type=RSA&amp;timestamp=2018-05-29+15%3A54%3A35&amp;version=1.0'</span><span>,  \n</span><span>    </span><span style=\"color:#986801\">success</span><span>: </span><span class=\"hljs-function\" style=\"color:#a626a4\">function</span><span class=\"hljs-function\">(</span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\">) </span><span>{            \n</span>        my.alert({\n<span>            </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res),\n</span>        });\n<!-- -->    },\n<span>    </span><span style=\"color:#986801\">fail</span><span>: </span><span class=\"hljs-function\" style=\"color:#a626a4\">function</span><span class=\"hljs-function\">(</span><span class=\"hljs-function hljs-params\">res</span><span class=\"hljs-function\">) </span><span>{  \n</span>        my.alert({\n<span>            </span><span style=\"color:#986801\">content</span><span>: </span><span style=\"color:#c18401\">JSON</span><span>.stringify(res),\n</span>        });\n<!-- -->    },\n<!-- -->});</code></pre></div></div></div></div></div></div></div><div class=\"pswp\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"pswp__bg\"></div><div class=\"pswp__scroll-wrap\"><div class=\"pswp__container\"><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div></div><div class=\"pswp__ui pswp__ui--hidden\"><div class=\"pswp__top-bar\"><div class=\"pswp__counter\"></div><button class=\"pswp__button pswp__button--close\" title=\"Close (Esc)\"></button><button class=\"pswp__button pswp__button--share\" title=\"Share\"></button><button class=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\"></button><button class=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\"></button><div class=\"pswp__preloader\"><div class=\"pswp__preloader__icn\"><div class=\"pswp__preloader__cut\"><div class=\"pswp__preloader__donut\"></div></div></div></div></div><div class=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\"><div class=\"pswp__share-tooltip\"></div></div><button class=\"pswp__button pswp__button--arrow--left\" title=\"Previous (arrow left)\"></button><button class=\"pswp__button pswp__button--arrow--right\" title=\"Next (arrow right)\"></button><div class=\"pswp__caption\"><div class=\"pswp__caption__center\"></div></div></div></div></div></div></article></main></div></div></div></div></div>\n    \n    \n  \n  <iframe src=\"https://tracert.alipay.com/cross.html\" style=\"width: 1px; height: 1px; position: absolute; left: -100px; bottom: -100px; display: none;\"></iframe></body></html>",
  "warning": "This scrape job was throttled at your current concurrency limit. If you'd like to scrape faster, you can upgrade your plan."
}